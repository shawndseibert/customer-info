<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Service Quote - Shawn Seibert</title>
    <link rel="stylesheet" href="customer-styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="theme-manager.js"></script>
</head>
<body>
    <div class="container">
        <header class="customer-header">
            <div class="logo-section">
                <i class="fas fa-door-open"></i>
                <h1>Shawn Seibert</h1>
            </div>
            <button id="themeToggle" class="theme-toggle" title="Toggle theme">
                <i class="fas fa-circle-half-stroke"></i>
            </button>
            <p class="tagline">Finding you the perfect doors and windows</p>
        </header>

        <div class="intro-section">
            <h2>Let me know what you need!</h2>
            <p>Fill out the form below and I'll contact you within 48 hours with a personalized quote for your door and window needs.</p>
            <div class="trust-indicators">
                <div class="trust-item">
                    <i class="fas fa-tags"></i>
                    <span>Parts & Pricing Expert</span>
                </div>
                <div class="trust-item">
                    <i class="fas fa-clock"></i>
                    <span>48hr or less response</span>
                </div>
                <div class="trust-item">
                    <i class="fas fa-star"></i>
                    <span>5-Star Service</span>
                </div>
            </div>
        </div>

        <div class="form-container">
            <form id="customerQuoteForm" class="quote-form">
                <!-- Personal Information -->
                <div class="form-section">
                    <h3><i class="fas fa-user"></i> Your Information</h3>
                    <div class="form-row">
                        <div class="form-field">
                            <label for="firstName">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required placeholder="John">
                        </div>
                        <div class="form-field">
                            <label for="lastName">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required placeholder="Smith">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label for="phone">Phone Number *</label>
                            <input type="tel" id="phone" name="phone" required placeholder="(555) 123-4567">
                        </div>
                        <div class="form-field">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" placeholder="john@example.com">
                        </div>
                    </div>

                    <div class="form-field">
                        <label for="address">Property Address *</label>
                        <div class="address-autocomplete-container">
                            <input type="text" id="address" name="address" required placeholder="Start typing your address..." autocomplete="off">
                            <div id="addressSuggestions" class="address-suggestions"></div>
                        </div>
                        <small>This helps us provide accurate estimates and scheduling</small>
                    </div>
                </div>

                <!-- Service Details -->
                <div class="form-section">
                    <h3><i class="fas fa-tools"></i> What Do You Need?</h3>
                    
                    <div class="form-field">
                        <label for="serviceType">Type of Service *</label>
                        <select id="serviceType" name="serviceType" required>
                            <option value="">Choose what you need...</option>
                            <option value="new-doors">New Door Installation</option>
                            <option value="new-windows">New Window Installation</option>
                            <option value="door-replacement">Replace Existing Door</option>
                            <option value="window-replacement">Replace Existing Windows</option>
                            <option value="door-parts">Door Hardware/Parts</option>
                            <option value="window-parts">Window Hardware/Parts</option>
                            <option value="repair">Repair Existing Door/Window</option>
                            <option value="consultation">Free Consultation</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label for="urgency">How Soon Do You Need This?</label>
                        <select id="urgency" name="urgency">
                            <option value="flexible">I'm flexible with timing</option>
                            <option value="month">Within the next month</option>
                            <option value="weeks">Within 2-3 weeks</option>
                            <option value="urgent">As soon as possible</option>
                            <option value="emergency">Emergency (broken/security issue)</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label for="description">Tell Us About Your Project</label>
                        <textarea id="description" name="description" rows="4" placeholder="Describe what you need... For example: 'Replace front door with steel door, looking for energy efficient option' or 'Three bedroom windows need replacement, prefer vinyl'"></textarea>
                        <small>Include materials, colors, sizes, or any special requirements</small>
                    </div>
                </div>

                <!-- Budget and Preferences -->
                <div class="form-section">
                    <h3><i class="fas fa-calculator"></i> Budget & Preferences</h3>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label for="budget">Estimated Budget Range</label>
                            <select id="budget" name="budget">
                                <option value="">Select budget range (optional)</option>
                                <option value="under-500">Under $500</option>
                                <option value="500-1000">$500 - $1,000</option>
                                <option value="1000-2500">$1,000 - $2,500</option>
                                <option value="2500-5000">$2,500 - $5,000</option>
                                <option value="5000-10000">$5,000 - $10,000</option>
                                <option value="over-10000">Over $10,000</option>
                                <option value="unsure">Not sure yet</option>
                            </select>
                            <small>This helps us provide appropriate options</small>
                        </div>
                        <div class="form-field">
                            <label for="preferredDate">Preferred Start Date</label>
                            <input type="date" id="preferredDate" name="preferredDate">
                            <small>We'll work with your schedule</small>
                        </div>
                    </div>

                    <div class="form-field">
                        <label for="contactPreference">Best Way to Contact You</label>
                        <select id="contactPreference" name="contactPreference">
                            <option value="phone">Phone Call</option>
                            <option value="text">Text Message</option>
                            <option value="email">Email</option>
                            <option value="any">Any method is fine</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label for="contactTime">Best Time to Contact</label>
                        <select id="contactTime" name="contactTime">
                            <option value="anytime">Anytime</option>
                            <option value="morning">Morning (8am-12pm)</option>
                            <option value="afternoon">Afternoon (12pm-5pm)</option>
                            <option value="evening">Evening (5pm-8pm)</option>
                            <option value="weekends">Weekends only</option>
                        </select>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="form-section">
                    <h3><i class="fas fa-comment"></i> Additional Information</h3>
                    
                    <div class="form-field">
                        <label for="heardAbout">How did you hear about us?</label>
                        <select id="heardAbout" name="heardAbout">
                            <option value="">Please select...</option>
                            <option value="google">Google Search</option>
                            <option value="referral">Friend/Family Referral</option>
                            <option value="facebook">Facebook</option>
                            <option value="nextdoor">Nextdoor</option>
                            <option value="flyer">Flyer/Advertisement</option>
                            <option value="drive-by">Saw your work in neighborhood</option>
                            <option value="yellowpages">Yellow Pages</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label for="additionalNotes">Anything Else We Should Know?</label>
                        <textarea id="additionalNotes" name="additionalNotes" rows="3" placeholder="Special access requirements, pet considerations, specific brands you prefer, etc."></textarea>
                    </div>
                </div>

                <div class="form-footer">
                    <div class="privacy-notice">
                        <i class="fas fa-lock"></i>
                        <small>Your information is secure and will only be used to provide your quote. We never share or sell customer data.</small>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i>
                        Get My Free Quote
                    </button>
                    
                    <div class="response-promise">
                        <i class="fas fa-clock"></i>
                        <span>We'll respond within 24 hours!</span>
                    </div>
                </div>
            </form>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="success-message" style="display: none;">
            <div class="success-content">
                <i class="fas fa-check-circle"></i>
                <h3>Thank You!</h3>
                <p>Your quote request has been submitted successfully. We'll contact you within 24 hours to discuss your project and schedule a free consultation.</p>
                <div class="next-steps">
                    <h4>What happens next?</h4>
                    <ul>
                        <li><i class="fas fa-phone"></i> We'll call/text you to confirm details</li>
                        <li><i class="fas fa-calendar"></i> Schedule a convenient time for consultation</li>
                        <li><i class="fas fa-clipboard-list"></i> Provide a detailed written estimate</li>
                    </ul>
                </div>
                <button onclick="submitAnother()" class="secondary-btn">Submit Another Request</button>
            </div>
        </div>

        <footer class="customer-footer">
            <div class="footer-content">
                <div class="contact-info">
                    <h4>Contact Us Directly</h4>
                    <p><i class="fas fa-phone"></i> Call: (615) 497-4983</p>
                    <p><i class="fas fa-envelope"></i> Email: shawn.d.seibert@gmail.com</p>
                </div>
                <div class="service-areas">
                    <h4>Service Areas</h4>
                    <p>Serving gallatin TN and surrounding areas</p>
                    <p>Free Estimates</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Address Autocomplete Script -->
    <script>
        // Address Autocomplete System for Customer Form
        class CustomerAddressAutocomplete {
            constructor() {
                this.addressInput = document.getElementById('address');
                this.suggestionsContainer = document.getElementById('addressSuggestions');
                this.currentHighlight = -1;
                this.suggestions = [];
                this.debounceTimer = null;
                
                // Common street names for suggestions
                this.commonStreets = [
                    'Main Street', 'Oak Street', 'First Street', 'Second Street', 'Third Street',
                    'Park Avenue', 'Washington Street', 'Lincoln Avenue', 'Maple Street', 'Cedar Street',
                    'Elm Street', 'Pine Street', 'Church Street', 'High Street', 'School Street',
                    'Spring Street', 'North Street', 'South Street', 'East Street', 'West Street',
                    'Broadway', 'Center Street', 'Mill Street', 'Union Street', 'Water Street'
                ];
                
                // Common cities
                this.commonCities = [
                    'Springfield', 'Franklin', 'Georgetown', 'Clinton', 'Greenville', 'Madison',
                    'Washington', 'Chester', 'Marion', 'Oxford', 'Bristol', 'Fairview', 'Salem',
                    'Kingston', 'Auburn', 'Richmond', 'Newport', 'Manchester', 'Plymouth', 'Dover'
                ];
                
                this.states = [
                    'AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA',
                    'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD',
                    'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ',
                    'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC',
                    'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY'
                ];
                
                if (this.addressInput && this.suggestionsContainer) {
                    this.init();
                }
            }
            
            init() {
                this.addressInput.addEventListener('input', (e) => this.handleInput(e));
                this.addressInput.addEventListener('keydown', (e) => this.handleKeydown(e));
                this.addressInput.addEventListener('blur', () => this.hideSuggestions());
                this.addressInput.addEventListener('focus', (e) => {
                    if (e.target.value.length > 0) this.handleInput(e);
                });
            }
            
            handleInput(e) {
                const value = e.target.value.trim();
                if (value.length < 2) {
                    this.hideSuggestions();
                    return;
                }
                
                clearTimeout(this.debounceTimer);
                this.debounceTimer = setTimeout(async () => {
                    await this.generateSuggestions(value);
                    this.showSuggestions();
                }, 300);
            }
            
            async generateSuggestions(input) {
                this.suggestions = [];
                const inputLower = input.toLowerCase();
                
                // Get previously saved addresses
                const savedAddresses = this.getSavedAddresses();
                
                // Add matching saved addresses first
                savedAddresses.forEach(address => {
                    if (address.toLowerCase().includes(inputLower)) {
                        this.suggestions.push({
                            type: 'saved',
                            full: address,
                            street: address.split(',')[0],
                            cityState: address.split(',').slice(1).join(',').trim()
                        });
                    }
                });
                
                // Always generate pattern suggestions
                this.generatePatternSuggestions(input);
                
                // Try to fetch real address suggestions from Nominatim
                if (input.length >= 3) {
                    try {
                        await this.fetchNominatimSuggestions(input);
                    } catch (error) {
                        console.log('Nominatim unavailable, using pattern suggestions');
                    }
                }
                
                // Limit to 8 suggestions
                this.suggestions = this.suggestions.slice(0, 8);
            }
            
            async fetchNominatimSuggestions(input) {
                const url = `https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&limit=5&countrycodes=us&q=${encodeURIComponent(input)}`;
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'User-Agent': 'CustomerQuoteForm/1.0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Nominatim request failed with status: ${response.status}`);
                }
                
                const data = await response.json();
                
                data.forEach(item => {
                    if (this.suggestions.length < 8) {
                        const address = this.formatNominatimAddress(item);
                        if (address.full) {
                            this.suggestions.push({
                                type: 'nominatim',
                                full: address.full,
                                street: address.street,
                                cityState: address.cityState
                            });
                        }
                    }
                });
            }
            
            formatNominatimAddress(item) {
                const addr = item.address || {};
                
                let street = '';
                if (addr.house_number) street += addr.house_number + ' ';
                if (addr.road) street += addr.road;
                else if (addr.street) street += addr.street;
                
                let cityState = '';
                if (addr.city) cityState += addr.city;
                else if (addr.town) cityState += addr.town;
                else if (addr.village) cityState += addr.village;
                
                if (addr.state) {
                    if (cityState) cityState += ', ';
                    cityState += addr.state;
                }
                
                if (addr.postcode) {
                    if (cityState) cityState += ' ';
                    cityState += addr.postcode;
                }
                
                const full = street + (cityState ? ', ' + cityState : '');
                
                return {
                    full: full,
                    street: street || item.display_name.split(',')[0],
                    cityState: cityState || item.display_name.split(',').slice(1, 3).join(',').trim()
                };
            }
            
            generatePatternSuggestions(input) {
                const inputLower = input.toLowerCase();
                const parts = input.split(/[,\s]+/);
                const firstPart = parts[0];
                
                if (input.length >= 2) {
                    if (/^\d+/.test(firstPart)) {
                        const houseNumber = firstPart.match(/^\d+/)[0];
                        const streetPart = input.replace(/^\d+\s*/, '').toLowerCase();
                        
                        this.commonStreets.slice(0, 3).forEach(street => {
                            if (streetPart === '' || street.toLowerCase().includes(streetPart)) {
                                if (this.suggestions.length < 8) {
                                    const fullAddress = `${houseNumber} ${street}, Springfield, IL`;
                                    this.suggestions.push({
                                        type: 'pattern',
                                        full: fullAddress,
                                        street: `${houseNumber} ${street}`,
                                        cityState: `Springfield, IL`
                                    });
                                }
                            }
                        });
                    } else {
                        this.commonStreets.slice(0, 3).forEach(street => {
                            if (street.toLowerCase().includes(inputLower)) {
                                if (this.suggestions.length < 8) {
                                    const fullAddress = `123 ${street}, Springfield, IL`;
                                    this.suggestions.push({
                                        type: 'pattern',
                                        full: fullAddress,
                                        street: `123 ${street}`,
                                        cityState: `Springfield, IL`
                                    });
                                }
                            }
                        });
                        
                        this.commonCities.slice(0, 3).forEach(city => {
                            if (city.toLowerCase().includes(inputLower)) {
                                if (this.suggestions.length < 8) {
                                    const fullAddress = `123 Main Street, ${city}, IL`;
                                    this.suggestions.push({
                                        type: 'pattern',
                                        full: fullAddress,
                                        street: `123 Main Street`,
                                        cityState: `${city}, IL`
                                    });
                                }
                            }
                        });
                    }
                }
            }
            
            showSuggestions() {
                if (this.suggestions.length === 0) {
                    this.hideSuggestions();
                    return;
                }
                
                this.suggestionsContainer.innerHTML = '';
                this.suggestions.forEach((suggestion, index) => {
                    const div = document.createElement('div');
                    div.className = 'address-suggestion';
                    div.innerHTML = `
                        <div class="street">${suggestion.street || 'No street'}</div>
                        <div class="city-state">${suggestion.cityState || 'No city/state'}</div>
                    `;
                    div.addEventListener('mousedown', (e) => {
                        e.preventDefault();
                        this.selectSuggestion(suggestion.full);
                    });
                    this.suggestionsContainer.appendChild(div);
                });
                
                this.suggestionsContainer.style.display = 'block';
                this.currentHighlight = -1;
            }
            
            hideSuggestions() {
                setTimeout(() => {
                    this.suggestionsContainer.style.display = 'none';
                }, 150);
            }
            
            handleKeydown(e) {
                const suggestionElements = this.suggestionsContainer.querySelectorAll('.address-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    this.currentHighlight = Math.min(this.currentHighlight + 1, suggestionElements.length - 1);
                    this.updateHighlight(suggestionElements);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    this.currentHighlight = Math.max(this.currentHighlight - 1, -1);
                    this.updateHighlight(suggestionElements);
                } else if (e.key === 'Enter' && this.currentHighlight >= 0) {
                    e.preventDefault();
                    this.selectSuggestion(this.suggestions[this.currentHighlight].full);
                } else if (e.key === 'Escape') {
                    this.hideSuggestions();
                }
            }
            
            updateHighlight(elements) {
                elements.forEach((el, index) => {
                    el.classList.toggle('highlighted', index === this.currentHighlight);
                });
                
                if (this.currentHighlight >= 0) {
                    elements[this.currentHighlight].scrollIntoView({ block: 'nearest' });
                }
            }
            
            selectSuggestion(address) {
                this.addressInput.value = address;
                this.hideSuggestions();
                this.saveAddress(address);
                this.addressInput.dispatchEvent(new Event('change', { bubbles: true }));
            }
            
            saveAddress(address) {
                const saved = this.getSavedAddresses();
                if (!saved.includes(address)) {
                    saved.unshift(address);
                    const limited = saved.slice(0, 20);
                    localStorage.setItem('customerSavedAddresses', JSON.stringify(limited));
                }
            }
            
            getSavedAddresses() {
                try {
                    return JSON.parse(localStorage.getItem('customerSavedAddresses') || '[]');
                } catch {
                    return [];
                }
            }
        }
        
        // Initialize address autocomplete when page loads
        window.addEventListener('load', () => {
            new CustomerAddressAutocomplete();
        });
    </script>
    
    <!-- No external dependencies needed for Google Sheets integration -->
    <script src="customer-script.js"></script>
</body>
</html>